repo "https://repo1.maven.org/maven2"
repo "https://oss.sonatype.org/content/groups/public/"
repo 'http://maven.kevoree.org/daum/snapshots'

include mvn:org.kevoree.microsandbox:org.kevoree.microsandbox.javasenode:latest
include mvn:org.kevoree.library.java:org.kevoree.library.java.channels:release
include mvn:org.kevoree.microsandbox:org.kevoree.microsandbox.monitoring:latest
include mvn:org.kevoree.microsandbox:org.kevoree.microsandbox.samples:latest

// Node definition
add node0 : MonitoredNode
set node0.availability_memory='150000000'
set node0.availability_instr='200000000'

//
add node0.MonitoringComponent0 : MonitoringComponent
set node0.MonitoringComponent0.memory_threshold='65'
set node0.MonitoringComponent0.cpu_threshold='10'
set node0.MonitoringComponent0.net_in_threshold='80'
set node0.MonitoringComponent0.net_out_threshold='80'

add node0.rankingComponent :ModelBasedRankingHeuristicComponent

add channelMonitoring1 : AsyncBroadcast
add channelMonitoring2 : AsyncBroadcast

bind node0.MonitoringComponent0.getRankingOrder channelMonitoring1
bind node0.rankingComponent.getRankingOrder channelMonitoring1

bind node0.MonitoringComponent0.triggerMonitoringEvent channelMonitoring2
bind node0.rankingComponent.triggerMonitoringEvent channelMonitoring2

//
//addComponent reasoner0@node0 : ResourceAwareReasoner

//addChannel defMSGT_reasoning : defMSG
//bind reasoner0.eventHandler@node0 => defMSGT_reasoning
//bind MonitoringComponent0.reasoner@node0 => defMSGT_reasoning

add node0.tester0 : CPUConsumerByPrimalityTesting
set node0.tester0.cpu_wall_time='4000000'
set node0.tester0.throughput_msg_per_second='all=8;primalityTester=8'

add node0.generator0 : NumberGenerator
set node0.generator0.frequency = '50'

add channelForNumbers : AsyncBroadcast

bind node0.tester0.primalityTester channelForNumbers
bind generator0.numbers channelForNumbers